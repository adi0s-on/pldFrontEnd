<div class="content">
  <div class="basic-data__tables">
    <p-table class="user-data__table" [value]="[user]">
      <ng-template pTemplate="header">
        <tr>
          <th>First name:</th>
          <th>Surname:</th>
          <th class="personal-data-button__container">City:
            <button *ngIf="!isEditingPersonalData"
                    (click)="isEditingPersonalData = true"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-pencil"
                    class="p-button-rounded p-button-outlined p-button-warning edit-toggle">
            </button>
            <button *ngIf="isEditingPersonalData"
                    (click)="acceptPersonalChanges()"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-check"
                    class="p-button-rounded p-button-outlined p-button-success edit-submit">
            </button>
            <button *ngIf="isEditingPersonalData"
                    (click)="cancelPersonalChanges()"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-times"
                    class="p-button-rounded p-button-outlined p-button-danger edit-submit">
            </button>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-user>
        <tr *ngIf="!isEditingPersonalData">
          <td>{{ user?.Name }}</td>
          <td>{{ user?.Surname }}</td>
          <td>{{ user?.City }}</td>
        </tr>
        <tr *ngIf="isEditingPersonalData">
          <td class="personal-data__td">
            <div class="p-col">
              <input class="personal-data__input"
                     type="text"
                     [placeholder]="'Enter name'"
                     [(ngModel)]="name"
                     pInputText>
            </div>
          </td>
          <td class="personal-data__td">
            <div class="p-col">
              <input class="personal-data__input"
                     type="text"
                     [placeholder]="'Enter surname'"
                     [(ngModel)]="surName"
                     pInputText>
            </div>
          </td>
          <td class="personal-data__td">
            <div class="p-col">
              <input class="personal-data__input"
                     type="text"
                     [placeholder]="'Enter city'"
                     [(ngModel)]="city"
                     pInputText>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <p-table class="user-details__table" [value]="[user?.UserDetails]">
      <ng-template pTemplate="header">
        <tr>
          <th>Height:</th>
          <th>Weight:</th>
          <th>Age:</th>
          <th>BMI:</th>
          <th class="details-data-button__container">BMR:
            <button *ngIf="!isEditingUserDetails"
                    (click)="isEditingUserDetails = true"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-pencil"
                    class="p-button-rounded p-button-outlined p-button-warning edit-toggle">
            </button>
            <button *ngIf="isEditingUserDetails"
                    (click)="acceptDetailsChanges()"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-check"
                    class="p-button-rounded p-button-outlined p-button-success edit-submit">
            </button>
            <button *ngIf="isEditingUserDetails"
                    (click)="cancelDetailsChanges()"
                    pButton
                    pRipple
                    type="button"
                    icon="pi pi-times"
                    class="p-button-rounded p-button-outlined p-button-danger edit-submit">
            </button>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-userDetails>
        <tr *ngIf="!isEditingUserDetails">
          <td>{{ userDetails?.Height }}</td>
          <td>{{ userDetails?.Weight }}</td>
          <td>{{ userDetails?.Age }}</td>
          <td>{{ userDetails?.BMI }}</td>
          <td>{{ userDetails?.BMR }}</td>
        </tr>
        <tr *ngIf="isEditingUserDetails">
          <td class="details-data__td">
            <div class="p-col">
              <input class="details-data__input"
                     type="number"
                     [placeholder]="'Enter height'"
                     [(ngModel)]="height"
                     pInputText>
            </div>
          </td>
          <td class="details-data__td">
            <div class="p-col">
              <input class="details-data__input"
                     type="number"
                     [placeholder]="'Enter weight'"
                     [(ngModel)]="weight"
                     pInputText>
            </div>
          </td>
          <td class="details-data__td">
            <div class="p-col">
              <input class="details-data__input"
                     type="number"
                     [placeholder]="'Enter age'"
                     [(ngModel)]="age"
                     pInputText>
            </div>
          </td>
          <td>{{ userDetails?.BMI }}</td>
          <td>{{ userDetails?.BMR }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-table [value]="user?.Diaries">
    <ng-template pTemplate="header">
      <tr>
        <th>
          <button (click)="toggleModal(ModalType.ADDING)"
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-plus"
                  class="p-button-rounded p-button-outlined p-button-success">
          </button>
        </th>
        <th>Start date:</th>
        <th>End date:</th>
        <th>Conclusions:</th>
        <th>Bench press start:</th>
        <th>Bench press end:</th>
        <th>Squat start:</th>
        <th>Squat end:</th>
        <th>Deadlift start:</th>
        <th>Deadlift end:</th>
        <th>Progress:</th>
        <th>Days:</th>
        <th>Actions:</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-userDiary let-i="rowIndex">
      <tr>
        <td>No. {{ i + 1 }} (Id {{ userDiary.Id }})</td>
        <td>{{ userDiary?.StartDate | date: 'dd.MM.yyyy'  }}</td>
        <td>{{ userDiary?.EndDate | date: 'dd.MM.yyyy'  }}</td>
        <td class="info__icon">
          <button pTooltip="{{ userDiary?.Conclusions }}"
                  tooltipPosition="top"
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-info"
                  class="p-button-rounded p-button-outlined p-button-info">

          </button>
        </td>
        <td>{{ userDiary?.BenchPressStart }} kg</td>
        <td>{{ userDiary?.BenchPressEnd }} kg</td>
        <td>{{ userDiary?.SquatStart }} kg</td>
        <td>{{ userDiary?.SquatEnd }} kg</td>
        <td>{{ userDiary?.DeadliftStart }} kg</td>
        <td>{{ userDiary?.DeadliftEnd }} kg</td>
        <td>{{ userDiary?.Progress }}</td>
        <td class="days-info__icon">
          {{ (userDiary?.Days ? userDiary?.Days?.length : '0') }}
          <button (click)="toggleModal(ModalType.DAYS, userDiary)"
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-info"
                  class="p-button-rounded p-button-outlined p-button-info">
          </button>
        </td>
        <td class="action__icon">
          <button (click)="toggleModal(ModalType.EDITING, userDiary)"
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-pencil"
                  class="p-button-rounded p-button-outlined p-button-warning">
          </button>
          <button (click)="toggleModal(ModalType.REMOVING, userDiary)"
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-trash"
                  class="p-button-rounded p-button-outlined p-button-danger">
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <app-context-dialog [displayModal]="modalToDisplay"
                      [diary]="diary"
                      [modalType]="operationType"
                      (modalClosed)="modalToDisplay = $event">
  </app-context-dialog>
</div>
